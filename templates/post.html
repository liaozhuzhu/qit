{%extends "base.html"%}

{%block title%}Posts{%endblock%}

{%block content%}
<div class="container-main" id="container-post">
    <div class="container-shadow" id="post-body">
        <h1 class="name-highlight-primary-purple" id="post-title">{{post.title|title}}</h1>
        <br/><br/>   
        <p>{{post.content|safe}}</p>
        <br/>   
        <div class="container-post-inner">
          <h1 class="post-username">{{post.poster.username}}</h1>
          {%if post.poster.pfp%}
          <img class="pfp-small" src="{{url_for('static', filename='images/' + post.poster.pfp)}}">
          {%else%}
          <img class="pfp-small" src="{{url_for('static', filename='images/pfp.png')}}">
          {%endif%}
          <h1 class="post-date">{{post.date_posted}}</h1>
        </div>
        <br/>
        <div class="container-inner" id="post-footer">
            {%if current_user.id == 1%}
                <a href="{{url_for('delete_post', id=post.id)}}" class="btn-primary-danger">Delete</a>
            {%elif post.poster_id == current_user.id%}    
                <a href="{{url_for('edit_post', id=post.id)}}" class="btn-secondary">Edit</a>
                <a href="{{url_for('delete_post', id=post.id)}}" class="btn-primary-danger">Delete</a>
            {%endif%}
            {%if current_user.is_authenticated%}
            {% if current_user.id in post.likes|map(attribute="liker")|list %}
            <i
              class="fa-solid fa-heart like-icon"
              id="like-button-{{post.id}}"
              onclick="like({{post.id}})"
            ></i>
            {% else %}
            <i
              class="fa-regular fa-heart like-icon"
              id="like-button-{{post.id}}"
              onclick="like({{post.id}})"
            ></i>
            {% endif %}
            <span id="likes-count-{{post.id}}">{{post.likes|length}}</span>
            {%endif%}
        </div>
    </div>  
    <a href="{{url_for('posts')}}" class="btn-primary">Back</a>
</div>
{%endblock%}